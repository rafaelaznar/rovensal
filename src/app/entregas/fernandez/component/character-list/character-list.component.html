<!-- Componente de lista de personajes -->
<div class="character-list-container">
  
  <!-- Encabezado con tÃ­tulo y filtro -->
  <div class="list-header">
    <h3 class="list-title">{{ title() }}</h3>
    
    <!-- Filtro por familia -->
    @if (showFamilyFilter()) {
      <div class="family-filter">
        <label for="family-select">Filtrar por Casa:</label>
        <select 
          id="family-select"
          [value]="selectedFamily()"
          (change)="onFamilySelectChange($event)"
          class="family-select">
          <option value="">Todas las Casas</option>
          @for (family of getUniqueFamilies(); track family) {
            <option [value]="family">{{ family }}</option>
          }
        </select>
      </div>
    }
  </div>
  
  <!-- Indicador de carga -->
  @if (loading()) {
    <div class="loading-container">
      <div class="spinner-large"></div>
      <p>Cargando personajes...</p>
    </div>
  }
  
  <!-- Lista de personajes -->
  @if (!loading() && getFilteredCharacters().length > 0) {
    <div class="characters-grid">
      @for (character of getFilteredCharacters(); track character.id) {
        <div 
          class="character-card"
          (click)="onCharacterSelect(character)"
          [class.selected]="character.id === getSelectedCharacter()?.id"
          role="button"
          tabindex="0"
          [attr.aria-label]="'Seleccionar ' + character.fullName">
          
          <!-- Imagen del personaje -->
          <div class="character-image-container">
            <img 
              [src]="getCharacterImage(character)"
              [alt]="character.fullName"
              (error)="onImageError($event)"
              class="character-image"
              loading="lazy">
            
            <!-- Overlay con informaciÃ³n adicional -->
            <div class="character-overlay">
              <span class="character-id">#{{ character.id }}</span>
            </div>
          </div>
          
          <!-- InformaciÃ³n del personaje -->
          <div class="character-info">
            <h4 class="character-name">{{ character.fullName }}</h4>
            
            @if (character.title) {
              <p class="character-title">{{ character.title }}</p>
            }
            
            @if (character.family) {
              <p class="character-family">
                <span class="family-label">Casa:</span>
                {{ character.family }}
              </p>
            }
          </div>
          
          <!-- Indicador de selecciÃ³n -->
          <div class="selection-indicator">
            <span class="checkmark">âœ“</span>
          </div>
        </div>
      }
    </div>
    
    <!-- InformaciÃ³n del conteo -->
    <div class="character-count">
      <p>
        Mostrando {{ getFilteredCharacters().length }} 
        @if (getFilteredCharacters().length !== characters().length) {
          de {{ characters().length }}
        }
        personajes
      </p>
    </div>
  }
  
  <!-- Estado vacÃ­o -->
  @if (!loading() && characters().length === 0) {
    <div class="empty-state">
      <div class="empty-icon">ğŸ‘¤</div>
      <h4>No hay personajes disponibles</h4>
      <p>No se encontraron personajes para mostrar.</p>
    </div>
  }
  
  <!-- No hay resultados de filtro -->
  @if (!loading() && characters().length > 0 && getFilteredCharacters().length === 0) {
    <div class="empty-state">
      <div class="empty-icon">ğŸ”</div>
      <h4>No hay resultados</h4>
      <p>No se encontraron personajes que coincidan con el filtro seleccionado.</p>
      <button 
        class="clear-filter-btn"
        (click)="onFamilyFilterChange('')">
        Limpiar filtro
      </button>
    </div>
  }
  
</div>